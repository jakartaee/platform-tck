<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<!--

    Copyright (c) 2018, 2020 Oracle and/or its affiliates. All rights reserved.

    This program and the accompanying materials are made available under the
    terms of the Eclipse Public License v. 2.0, which is available at
    http://www.eclipse.org/legal/epl-2.0.

    This Source Code may also be made available under the following Secondary
    Licenses when the conditions for such availability set forth in the
    Eclipse Public License v. 2.0 are satisfied: GNU General Public License,
    version 2 with the GNU Classpath Exception, which is available at
    https://www.gnu.org/software/classpath/license.html.

    SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0

-->
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta http-equiv="CONTENT-TYPE"
 content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR"
 content="Mozilla/4.79 [en] (Windows NT 5.0; U) [Netscape]">
  <meta name="AUTHOR" content="Kyle Grucci">
  <meta name="CREATED" content="20020315;14133057">
  <meta name="CHANGEDBY" content="Kyle Grucci">
  <meta name="CHANGED" content="20020409;12410874">
  <style>
	<!--
		@page { margin-left: 1.25in; margin-right: 1.25in; margin-top: 1in; margin-bottom: 1in }
	-->
	</style>
</head>
<body>
<div style="margin-bottom: 0in;">
<div style="margin-bottom: 0in;"><b><font size="+3">Test Developer's
Guide
for CTS 1.4 and Related TCKs</font></b></div>
<b><font size="+1">(in progress)<br>
<br>
Table of Contents (these should be links into the doc)</font></b>&nbsp;<br>
<p><b><font size="+1">1.0 Creating an Assertion List for a Technology
Specification</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; -just point to Kevin's process
doc?</font></b>
<br>
<b><font size="+1">2.0 Creating a TestPlan</font></b>
<br>
<b><font size="+1">3.0 Developing Tests for a Technology</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; 3.1 End-to-End Tests</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; 3.2 API (Service) Tests</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; 3.3 Signature Tests</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; 3.4 Using Existing Porting classes</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; 3.5 Common Apps</font></b>
<br>
<b><font size="+1">&nbsp;&nbsp;&nbsp; 3.6 Source File headers
(copyrights
and sccs keywords)</font></b>
<br>
<b><font size="+1">4.0 </font></b><b><font size="+1">Creating a
Deliverable (TCK)</font></b>
<br>
<b><font size="+1">5.0 </font></b><b><font size="+1">Building Tests</font></b>
<br>
<b><font size="+1">6.0 </font></b><b><font size="+1">Creating a
Porting Class</font></b><b><font size="+1"><br>
7.0&nbsp; Running Tests<br>
</font></b></p>
</div>
<div style="margin-bottom: 0in;"><b><font size="+1">Appendix A &#8211; Inside
the
Test Harness</font></b></div>
<div style="margin-bottom: 0in;"><b><font size="+1">Appendix B &#8211; Spider
Directory
structure</font></b></div>
<div style="margin-bottom: 0in;"><b><font size="+1">Appendix C &#8211; ANT
custom
Tasks</font></b></div>
<div style="margin-bottom: 0in;"><b><font size="+1">Appendix D &#8211; FAQ</font></b></div>
<br>
&nbsp;
<p><b><font size="+1">1.0 Creating an Assertion List for a Technology
Specification</font></b>
</p>
<p><b>&nbsp;&nbsp;&nbsp; </b>For each Technology specification, an
assertion
list must be created.&nbsp; For details, please see the Assertion
Process
document (link here).&nbsp; In general, two documents will exist for
each
technology specification, one from the written specification and
another
from the corresponding javadoc.&nbsp; Each one must be an xml document
and must follow the rules in the assertion list dtds (links to spec and
javadoc dtds here).&nbsp; These documents must be checked into the
workspace
under $TS_HOME/internal/docs/&lt;tech-name&gt;/&lt;spec-version&gt;
subtree (e.g.
internal/docs/ejb/2.1).&nbsp; The documents should be named
&lt;tech-name&gt;SpecAssertions.xml
and &lt;tech-name&gt;JavadocAssertions.xml.&nbsp; At build time, the
xml documents
should be run through a predefined style sheet to create external html
versions of the lists which will be included in any deliverables.
</p>
<p><b>1.1 XML Tools</b>
</p>
<p>&nbsp;&nbsp;&nbsp; Describe available tools - both editing tools and
utilities from the tools ws.
</p>
<p><b><font size="+1">2.0 Creating a Test Plan for a Technology
Specification</font></b>
</p>
<p><b><font size="+1">&nbsp;&nbsp;&nbsp; </font></b>Test plans should
be
created according to the template (link to Steve C's doc)
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">3.0 Developing tests
for
a particular technology</font></b>
</p>
<p>&nbsp;&nbsp;&nbsp; All tests that are integrated into the spider
workspace
must follow this list of conventions...
</p>
<p><b>Checklist of Conventions for All tests</b>
</p>
<p>1.&nbsp; All test names should be meaningful and should not include
numbers.&nbsp; Instead of simply naming tests... test1, test2, test3,
use
names like, statefulCreateTest, resultSetTest, etc.
<br>
1.&nbsp; Test Clients must include test description tags as well as
setup.props tags.
<br>
2.&nbsp; All test names must have the string "test" (case-insensitive)
in it.
<br>
3.&nbsp; All technology areas should have a top level directory under
the "com.sun.ts.tests" package.
<br>
4.&nbsp; All source java sources must live under the $TS_HOME/src
directory
and under src, the directory structure must correspond to the java
package
for sources.
<br>
5.&nbsp; All web content used by tests must live under the
$TS_HOME/src/web
directory.
<br>
4.&nbsp; No TCK or Deliverable specific strings should appear under
the src tree (with the exception of Deliverable specific files under
the
"com.sun.ts.lib.deliverable.&lt;deliv-name&gt;" package. For example,
do not
name a source file CTSTests.java, or name a variable name sCTSString.
<br>
5.&nbsp; All source files should be saved in unix file format.&nbsp;
If you use an editor on the win32 platform, be sure to save the file in
unix format prior to checkin.&nbsp; Some PC editors have an option to
do
this automatically.
<br>
6.&nbsp; Follow the Java Software coding conventions http://???.
<br>
7.&nbsp; All directory names should be lowercase.
</p>
<p>&nbsp;&nbsp;&nbsp; Each test always begins in a test Client, either
an application client for a URL client.&nbsp; The Client's .java file
is
required to contain a test description for each test that begins in
that
class.&nbsp; Test Descriptions are written in Javadoc comments withthe
exception of the addtional '*' that is required by Javadoc
comments.&nbsp;
Just use standard multiline comment notation.&nbsp; Here are some
sample
setup and Test Description tags from a JAX-RPC client .java file...
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font
 face="Courier New,Courier"><font size="-1">/*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @class.setup_props: webServerHost;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
webServerPort;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ts_home;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*/</font></font><font face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
/*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @testName:&nbsp; AttachmentsTest</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @assertion_ids: JAXRPC:SPEC:41; JAXRPC:SPEC:42;
JAXRPC:SPEC:304;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JAXRPC:SPEC:310;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @test_Strategy: Create a stub instance to our service
definition</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; interface, set the target endpoint to the servlet,</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; and invoke the RPC methods for each primitive type.</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; For each primitive type pass its value as input to the</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; corresponding RPC method and receive it back as the</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; return value. Compare results of each value/type of</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; what was sent and what was returned. Verify they are</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; equal.</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*/</font></font>
</p>
<p>&nbsp;&nbsp;&nbsp; The class.setup_props tag is optional.&nbsp; If
your
tests require properties from the ts.jte file, then you must include
this
tag along with any properties your tests rely on.&nbsp; The values for
the properties specified will be passed to the setup method of your
client
class.&nbsp; If possible, limit the number of test descriptions per
client
source file to under 20.&nbsp; For each test description, the following
tags are required...
</p>
<p>&nbsp;&nbsp;&nbsp; <b>@testName:</b>&nbsp; The name of this
test.&nbsp;
This value should be something meaningful and must contain the
case-insensitive
substring, "test".&nbsp; There must also be a method on this class
which
matches the testname.
<br>
<b>&nbsp;&nbsp;&nbsp; @assertion_ids:</b> One or more assertion IDs
which are tested by this test.&nbsp; NOTE:&nbsp; Only put those
assertion
IDs which are explicitely tested by this test.&nbsp; Do not put any and
all assertion IDs which happen to be covered in this test, even though
the purpose of the test is to verify something else.&nbsp; For example,
most EJB tests create EJBs.&nbsp; There is no need to specify the&nbsp;
assertion ID for creating an EJB in every EJB test description
<br>
&nbsp;&nbsp;&nbsp; <b>@test_Strategy:</b> This is a brief descrioption
of the approah that was taken to test the specified assertions.
<br>
&nbsp;&nbsp;&nbsp; <b>@class.testArgs: </b>Additional arguments (if
any) to be passed when execing the client class.
</p>
<p>&nbsp;&nbsp;&nbsp; Each tag name must end with a colon and then at
least
one whitespace prior to the first tag value.&nbsp; For tags that can
possibly
have multiple values, like class.setup_props and assertion_ids, a
semi-colon
must separate each tag value.&nbsp; Tag values may or may not span
multiple
lines.&nbsp; The JavaTest harness will read each test desription and
count
it as a single test found.&nbsp; For API tests, for each test
description,
one to four tests may be counted based on the number of vehicles that
the
test is required to run in.
</p>
<p>&nbsp;&nbsp;&nbsp; It is recommended that all classes associated
with
a directory of tests live in that test directory (e.g. If a test has a
client which talks to an ejb, then the ejb classes should also appear
in
this test directory).&nbsp; However, in some cases (where many
different
classes in different test directories extend a common base class) this
doesn't make sense.&nbsp; In the case where common utility classes (not
those in com.sun.ts.lib) are shared across multiple technology
directories,&nbsp;
these classes should go under the com.sun.ts.tests.common directory.
</p>
<p>&nbsp;&nbsp;&nbsp; When developing a set of tests for a given
technology,
you will want to ask yourself the following questions...
</p>
<p>1.&nbsp; Is this API going to be part of the J2EE Platform?
<br>
2.&nbsp; If you answered "yes" to question 1, then is it possible that
this API will be accessible and therefore testable from multiple J2EE
containers?&nbsp;
If so, then you will probably want some (if not all) of your test
clients
to extend ServiceEETest. This base class provides for automatic
distribution
of your test clients to any of 4 possible generic Vehicle components -
ejb, servlet, jsp, and appclient.&nbsp; See section ??.
<br>
&nbsp;
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">3.1 End-to-End Tests</font></b>
</p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; End-to-End Tests (EE)
are tests that start in a client (application client or URL client),
accesses
some server-side component, and then possibly access some other
resource
such as a back-end database.&nbsp; When writing these types of tests,
the
test developer is responsible for writing and building each
component.&nbsp;
All EE test clients must extend the class,
com.sun.ts.lib.harness.EETest.&nbsp;&nbsp;
They must also provide at least one setup, cleanup, and
&lt;testname&gt; method.&nbsp;
Most client classes provide single setup and cleanup methods and many
&lt;testname&gt;
methods, since all tests defined in the client are similar enough to
share
thesetup and cleanup.&nbsp; A main method must also be provided, since
each test client is execed in a separate VM by the Javatest
harness.&nbsp;
A sample ejb test client is shown below...
</p>
<div style="margin-bottom: 0in;"></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">package
com.sun.ts.tests.samples.ejb.ee.simpleHello;</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
java.io.*;</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
java.util.*;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
jakarta.ejb.EJBHome;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
com.sun.ts.lib.util.*;</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
com.sun.ts.lib.porting.*;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
com.sun.ts.lib.harness.*;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">/**</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;*
The HelloClient class tests creating a simple hello bean</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;*
@author&nbsp; Tester</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;*
@version 1.23, 03/20/02</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;*/</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">import
com.sun.javatest.Status;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">public
class HelloClient extends&nbsp; EETest</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
final static String helloStr = "Hello World!";</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private static final String testName = "HelloTest";</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private static final String testProps = "sessionbean.properties";</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private static final String testDir = System.getProperty("user.dir");</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
//Naming specific member variables</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private TSNamingContextInterface jc = null;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
//Harness requirements</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private Hello hr=null;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private HelloHome home = null;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private StringBuffer logData=null;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
private Properties props=null;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
public static void main(String[] args)</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
HelloClient theTests = new HelloClient();</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Status s=theTests.run(args, System.out, System.err);</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
s.exit();</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
/*&nbsp; Test setup: */</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
/*</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @class.setup_props: org.omg.CORBA.ORBClass;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
java.naming.factory.initial;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*/</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
public void setup(String[] args, Properties p) throws Fault</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
props=p;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
try</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jc= new TSNamingContext();</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg("Looked up home!!");</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
home = (HelloHome)jc.lookup("java:comp/env/ejb/Hello", HelloHome.class);</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg("Setup ok;");</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
catch( Exception e )</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
throw new Fault("Setup Failed!", e);</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
/* Run test */</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
/*</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
* @testName:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; helloTest</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
* @assertion_ids:&nbsp;&nbsp;&nbsp; SAMPLE:SPEC:41</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
* @test_Strategy:&nbsp;&nbsp;&nbsp; Create a stateful Session EJBean.</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Deploy it on the J2EE server.</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
From the EJB client. call the sayHello()</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
business method.</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
It should return the "hello world" string.</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*/</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
public void helloTest() throws Fault</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
try</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
hr = home.create(helloStr,props);</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// invoke method on the EJB</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg( hr.sayHello());</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg("Test passed;");</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
catch( Exception e )</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
throw new Fault("Test Failed!", e);</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
/* cleanup -- none in this case */</font></font>
</p>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
public void&nbsp; cleanup() throws Fault</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
{</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg("Cleanup ok;");</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">&nbsp;&nbsp;&nbsp;
}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1">}</font></font></div>
<div style="margin-bottom: 0in;"><font face="Courier New,Courier"><font
 size="-1"></font></font></div>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; The test client's
main
method is called when it is execed in its own VM.&nbsp; From there, the
parent class' run method is called.&nbsp; This method will use
reflection
to call the setup method.&nbsp; If that method does not throw a Fault,
then the &lt;testname&gt; method is called.&nbsp; If setup did throw a
Fault,
then the &lt;testname&gt; method is not called.&nbsp; The cleanup
method is
always called.
</p>
<div style="margin-bottom: 0in;"></div>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; The ejb classes for
this
</p>
<div style="margin-bottom: 0in;"></div>
&nbsp;
<div style="margin-bottom: 0in;"><b><font size="+1"></font></b></div>
<p style="margin-bottom: 0in;"><b><font size="+1">3.2 API (Service)
Tests</font></b>
</p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; The name, "Service
Tests"
dates back to the first days of the J2EE-CTS where several APIS were
defined
to be available and testable within different J2EE containers.&nbsp;
These
tests differed from End-to-End tests which focused on component
lifecycles
and multi-tier scenarios.&nbsp; These APIs could be thought of as
"services"
available to each container, thus the name "Service Tests".&nbsp; With
the advent of "Web Services", we should probably just refer to these
types
of tests as API tests to avoid any confusion.&nbsp; When writing these
types of tests, the test developer is only resonsible for writing the
test
client and for passing this client (and any utility classes to the
Vehicles
task to be built.&nbsp; The Vehicles task will automatically build the
components that this API should be run in as defined by the
DeliverableInterface
implementation.
</p>
<p style="margin-bottom: 0in;">When writing your Test Client, focus on
testing
the API, irrespective of where the client is going to be run
from.&nbsp;
The Client class must do the following...
</p>
<p style="margin-bottom: 0in;">-Extend
com.sun.ts.lib.harness.ServiceEEtest
</p>
<div style="margin-bottom: 0in;">-Implement java.io.Serializable
(eventually
change to implement com.sun.ts.lib.harness.ServiceEEInterface)</div>
<div style="margin-bottom: 0in;">-If necessary, override deployment
descriptor
and RI specific runtime.xml files (default files are picked up from
vehicle
directories under src/com/sun/ts/tests/common/vehicles</div>
<p><br>
A sample API test client is presented below ( from
$TS_HOME)/src/com/sun/ts/tests/samples/jdbc/ee/testConn)
</p>
<p><font face="Courier New,Courier"><font size="-1">package
com.sun.ts.tests.samples.jdbc.ee.testConn;</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">import java.io.*;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">import java.util.*;</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">import java.sql.*;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">import javax.sql.*;</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">import
com.sun.ts.lib.util.*;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">import
com.sun.ts.lib.porting.*;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">import
com.sun.ts.lib.harness.*;</font></font><font face="Courier New,Courier"><font
 size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">import
java.rmi.RemoteException;</font></font><font face="Courier New,Courier"><font
 size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">import
com.sun.javatest.Status;</font></font><font face="Courier New,Courier"><font
 size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">public class
testConnClient
extends ServiceEETest implements Serializable</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">{</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
//
private static final String testName = "samples.jdbc.ee.testConn";</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; //
Naming specific member variables</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
private
TSNamingContextInterface jc = null;</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
//
Harness requirements</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
private
transient Connection conn = null;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
private
DataSource ds1 = null;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
private
Properties props = null;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; //
Tables to be created</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
private
String pTableName = null;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
private
String fTableName = null;</font></font><font face="Courier New,Courier"><font
 size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
/*
Run test in standalone mode */</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
public
static void main(String[] args)</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; {</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
testConnClient theTests = new testConnClient();</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Status s=theTests.run(args, System.out, System.err);</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
s.exit();</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; }</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
/*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @class.setup_props: Driver;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
db1;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user1;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
password1;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
db2;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user2;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
password2;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
DriverManager;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ptable;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ftable;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cofSize;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cofTypeSize;</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp; @class.testArgs:&nbsp;&nbsp;&nbsp; -ap tssql.stmt</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*/</font></font><font face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
public
void setup(String[] args, Properties p) throws Fault</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; {</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
try</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
try</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
props = new Properties(p);</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pTableName = p.getProperty("ptable");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fTableName = p.getProperty("ftable");</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestUtil.logTrace("Getting the initial context...");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jc = new TSNamingContext();</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestUtil.logTrace("Initial context: " + jc.toString());</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestUtil.logTrace("Looking up the JNDI DataSource names");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ds1 = (DataSource)jc.lookup("java:comp/env/jdbc/DB1");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestUtil.logTrace("ds1: " + ds1.toString());</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
getConnection();</font></font><font face="Courier New,Courier"><font
 size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
catch(SQLException ex)</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logErr("SQL Exception : " + ex.getMessage());</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
catch( Exception e )</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logErr("Setup Failed!");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestUtil.printStackTrace(e);</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; }</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
/*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
* @testName:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
testCreateTable</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
* @assertion:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; To verify this
JDBC connection can create tables.</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
* @test_Strategy:&nbsp;&nbsp;&nbsp; Using the Connection object created
in the setup()</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
method, create a table, insert rows into it, then</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
drop it.&nbsp; This sample will ensure that your environment is</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
suitable to run the JDBC tests.</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;
*/</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
public
void testCreateTable() throws Fault</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; {</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
try</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
createTable(props, conn);</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
catch (RemoteException re)</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TestUtil.logMsg("Remote exception on createTable: " + re.getMessage());</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
throw new Fault("Call to testCreateTable Failed.");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; }</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
/*
cleanup */</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;
public
void cleanup() throws Fault</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; {</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
try</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dropTables(conn);</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg("Dropped tables OK");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
conn.close();</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logMsg("Closed connection OK");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
catch (Exception e)</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logErr("An error occurred while closing the database connection");</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
logErr(e.getMessage());</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></font>
<br>
<font face="Courier New,Courier"><font size="-1">&nbsp;&nbsp;&nbsp; }</font></font><font
 face="Courier New,Courier"><font size="-1"></font></font>
</p>
<p><font face="Courier New,Courier"><font size="-1">}</font></font>
<br>
&nbsp;
<br>
&nbsp;
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">3.3 Signature Tests</font></b>
</p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; Signature tests
should
be written for each technolgy area (XXX Add more here)
<br>
&nbsp;
<br>
<b><font size="+1">3.4 Using Existing Porting classes</font></b>
<br>
<b><font size="+1">3.5 Common Apps</font></b>
<br>
<b><font size="+1">3.6 Source File headers (copyrights
and sccs keywords)</font></b>
</p>
<p style="margin-bottom: 0in;">&nbsp;<br>
<b><font size="+1">4.0 Creating a Deliverable (TCK)</font></b>
<br>
</p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; This section contains
instructions for creating a deliverable out of the Spider workspace. A
deliverable is generically defined as any bundle of tests that is
released
to some customer (internal or external).&nbsp; An example deliverable
would
be the CTS or the JAXRPC-TCK. I can imagine that we might want to
create
a deliverable for the CTS smoke tests.&nbsp; Every deliverable must
have
the following in the spider workspace...
</p>
<p style="margin-bottom: 0in;">1.&nbsp; An install directory
</p>
<div style="margin-bottom: 0in;">2.&nbsp; Some subset of tests from
under
$TS_HOME/src</div>
<div style="margin-bottom: 0in;">3.&nbsp; A deliverable specific
library
jar</div>
<div style="margin-bottom: 0in;">4.&nbsp; An implementation of
com.sun.ts.lib.deliverable.DeliverableInterface
and com.sun.ts.lib.deliverable.PropertyManagerInterface</div>
<div style="margin-bottom: 0in;">5.&nbsp; A "createzip" script or ANT
target
in a build.xml file under $TS_HOME/release</div>
&nbsp;&nbsp;&nbsp; Once a deliverable exists in the spider workspace,
any
developer can build and run tests according to that deliverable's
rules.&nbsp;
To do this, one would cd into the $TS_HOME/install/&lt;deliv-name&gt;
directory
and run "ant setup".&nbsp; This step should copy the contents of the
deliverable's install directory to the corresponding spider top level
directory.&nbsp;
This makes &lt;deliv-name&gt; the <i>active</i> deliverable in the
workspace.&nbsp;
Any building or running from this point up until a different
deliverable's
setup target is run will behave according to the active deliverable's
rules
as defined in
<p style="margin-bottom: 0in;"><b>Your Deliverable's install directory</b>
</p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; Under the
$TS_HOME/install
directory, create a subdirectory which describes your deliverable (e.g
j2ee, jaxrpc, jaxr, smoke, etc.). This directory will hold
configuration
files for your deliverable. Within the workspace, when setup is run for
this deliverable, the files in this subdir will be copied to top level
directories in the workspace. Any tests that are built or run from that
point (until a different deliverable's setup is run) will do so
according
to this deliverable's configuration and build files. A sample
deliverable's
install directory might look like the following...
</p>
<p style="margin-bottom: 0in;">install
</p>
<div style="margin-bottom: 0in;">&nbsp;&nbsp; -jaxrpc</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-setup.xml
(ANT file with a default setup target)</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-bin</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(ts.jte, ts.jtx, etc.)</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(ANT files &#8211; build.xml, build.properties)</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-lib</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-deliverable
specific library jar</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-docs</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-user's guide for this Deliverable</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-other</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-testsuite.jtt (copied to src/com/sun/ts/tests)</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-map.jtc (copied to src/com/sun/ts/tests)</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; A deliverable's
install
directory will contain any files that are specific to that deliverable,
including docs and configuration files. The build files (see directory
structure above) will be copied to the bin directory and will be used
to
customize any build rules for the TCK. (NOTE: All lower leaf level
build.xml
files in the src tree should contain calls to our custom tasks to be
packaged
in whatever way they will be packaged when they are part of the
J2EE-CTS.
The new ANT package task will automatically check the build.level
property
(required in build.properties) which can be customized by TCKs. Valid
values
for this property are... 1=compile, 2=components, 3=applications. If,
for
example, you have a set of tests that should be built as wars for a TCK
deliverable and built into ears when shipped with the J2EE-CTS, then
your
TCK's build.properties file would set this property to 2. The CTS'
build.properties
would set it to 3.)</div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; After running setup
for your deliverable in the workspace (NOTE: There will be no install
directory
in any of the deliverable bundles. The install directory only exists in
the workspace in order for developers to switch between different
deliverables.
In a bundle, the deliverable is known. Also, the only platform specific
scripts that should exist in a bundle would be the ant scripts.
All other tasks should be done through ANT targets.), you will be able
to build and run your TCK. Your createzip (should eventually be
converted
to ant target) script should copy the directory structures and files
necessary
for your Deliverable to a staging directory. Then, it should be built
from
here. This will ensure that what you are bundling will be buildable
without
relying on any other files that exist in the spider workspace. (TBD:
BOM
should be created and checked for each deliverable)</div>
<div style="margin-bottom: 0in;"><b>Deliverable Specific Library Jar</b></div>
<div style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; Each deliverable
must
define a "tslib" target in its bin level build.xml file. This target
should
create a library jar containing Deliverable specific class files. The
name
of the jar should follow the naming convention,
&lt;deliv-name&gt;ts.jar (e.g.
jaxrpcts.jar, jaxrts.jar, jstlts.jar, etc.). The contents of this jar
should
only contain class files from the com.sun.ts.lib package or any of its
sub-packages. The files to be jarred might include porting
implementation
classes. This jar along with the core tsharness.jar will take the place
of the current j2eects.jar. The tslib target should create the jar in
the
$TS_HOME/lib directory. It should then be copied to the
install/&lt;deliv-name&gt;/lib
directory and be checked into the workspace. During setup of the
deliverable,
it will be copied to the $TS_HOME/lib directory.</div>
<div style="margin-bottom: 0in;">(TBD: Walk through a sample
deliverable)</div>
<b>Implementing DeliverableInterface and PropertyManagerInterface</b>
<br>
&nbsp;
<p style="margin-bottom: 0in;"><b>Creating Your Deliverable Bundle</b>
</p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; A createzip ANT
build.xml
file should be created under the release directory with a default
target
of "createzip".
<br>
&nbsp;
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">5.0 </font></b><b><font
 size="+1">Building Tests</font></b>
</p>
<p>Creating leaf directory build.xml files
</p>
<p style="margin-bottom: 0in;">Once you've created your test sources,
you
must then create an ANT build.xml file in your test source directory.
Please
see the complete documentation on the custom tasks (link to custom
tasks
here) that exist for the spider workspace. From any point in the src
directory
(excluding under com/sun/ts/lib), you should be able to build using the
<i>ant</i>
command. Please see the sample leaf level build.xml file below...
</p>
<p style="margin-bottom: 0in;">&lt;insert ejb sample here&gt;
</p>
<p style="margin-bottom: 0in;">The build.xml files have become much
simpler
due to default values being set for many attributes. By default, all
components,
application archives, deployment descriptors, and RI runtime.xml files
will be generated or copied into the appropriate package structure
under
$TS_HOME/dist. Your test directory will not be modified.
</p>
<p style="margin-bottom: 0in;">-build files (ANT).
</p>
<p style="margin-bottom: 0in;">All packaging is done through ANT custom
tasks that are called from individual build.xml files. The
&lt;package&gt;
task will check the build.level property in the bin/build.properties
file
for the deliverable that you are building for. It will use this value
to
determine whether to build only components (wars, jars, rars) or
applications
(ears) as well. Support for further configuration values may be added
in
the future. This property allows for high level control of what gets
built
<br>
&nbsp;
<br>
&nbsp;
</p>
<p style="margin-bottom: 0in;">Building tests
</p>
<p style="margin-bottom: 0in;">&nbsp;To build only a certain
subdirectory of tests, cd into a given test directory under
$TS_HOME/src and type "ant".&nbsp; This will build all tests under
this directory.&nbsp; Most deliverables' top level build file
($TS_HOME/bin/build.xml) contains a target to build all tests for that
particular deliverable.&nbsp; In the case of the CTS, the target is
called build.all.tests.<br>
&nbsp;<br>
&nbsp;
<br>
&nbsp;<b><font size="+1">6.0 Creating a Porting Interface<br>
</font></b></p>
<p style="margin-bottom: 0in;"><font size="+1">TBD</font><b><font
 size="+1"><br>
</font></b></p>
<p style="margin-bottom: 0in;"><small><b><font size="+2"><small>7.0
Running Tests</small></font></b>
</small></p>
<p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp; Almost everything in
the
spider workspace or bundle generated from the workspace is done through
an ANT target.&nbsp; The only platform specific script and bat files
are
those belonging to ANT (ant/ant.bat).&nbsp;
All ant targets should be accessed through the wrapper script and bat
files.&nbsp;
These wrappers provide added functionality through an ANT build
listener
to set default values for locations in the workspace.
<br>
&nbsp; <br>
</p>
<p style="margin-bottom: 0in;">cd into any test directory under
$TS_HOME/src/com/sun/ts/tests and type "ant runclient" to run any
tests in the current directory as well as any sub-directories. To run
an individual test cd into the test leaf directory and invoke: "ant
-Dtest=&lt;test-name&gt; runclient" where &lt;test-name&gt; is the name
of the test you wish to invoke.<br>
&nbsp;
<br>
&nbsp;
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">Appendix A &#8211; Inside
the
Test Harness</font></b>
</p>
<p style="margin-bottom: 0in;">We provide an implementation for the
Javatest Script and TestFinder interfaces...<br>
</p>
<p style="margin-bottom: 0in;">com.sun.ts.lib.harness.TSScript<br>
com.sun.ts.lib.harness.TSTestFinder<br>
</p>
<p style="margin-bottom: 0in;"><span style="font-weight: bold;">The
Harness Packages</span><br>
</p>
<p style="margin-bottom: 0in;"><span style="font-weight: bold;">com.sun.ts.lib.harness
</span><br>
&nbsp;<br>
This package includes the core harness classes responsible for...
<br>
<br>
-finding and returning test descriptions
<br>
-running test clients
<br>
-determining deployable archives
<br>
-customization of runtime information from configuration files
<br>
-providing common functionality for test clients
<br>
<br>
<span style="font-weight: bold;">com.sun.ts.lib.deliverable</span>
<br>
</p>
<p style="margin-bottom: 0in;">This package provides the necessary
interfaces for abstracting deliverable specific functionality from the
core harness package.&nbsp; Each TCK may require customized
implementations of these interfaces. Examples of deliverables include
the CTS and other TCKs. Implementations for some of these are included
in subpackages.
<br>
<br>
<span style="font-weight: bold;">com.sun.ts.lib.porting
</span><br>
</p>
<p style="margin-bottom: 0in;">This package contains the factories,
proxies,and interfaces for all porting packages.&nbsp; It also contains
a DeploymentInfo class which contains runtime information necessary to
deploy an app on a J2EE server.
<br>
<br>
<span style="font-weight: bold;">com.sun.ts.lib.util
</span><br>
</p>
<p style="margin-bottom: 0in;">This package provides general utility
classes for distributed logging, web test support, naming context
creation, and standalone deployment
<br>
<br>
<span style="font-weight: bold;">com.sun.javatest.SimpleDefaultInterviewparameters
</span><br>
&nbsp;<br>
This class provides a simple interview for the Javatest harness.
Default values are determined by the deliverable.
<br>
<br>
<span style="font-weight: bold;">com.sun.ts.lib.implementation
</span><br>
&nbsp;<br>
This package provides Sun reference implementation classes for each of
the porting interfaces in the porting package.
<br>
<br>
<span style="font-weight: bold;">com.sun.ts.lib.tests
</span><br>
&nbsp;<br>
This package contains some general technology specific utility classes
such as those used to drive the web clients for jsp, servlet, jstl, etc.
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">Appendix B &#8211; Spider
Directory
structure</font></b>
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">Appendix C &#8211; ANT
custom
Tasks</font></b>
</p>
<p style="margin-bottom: 0in;"><b><font size="+1">Appendix D &#8211; FAQ</font></b>
</p>
<p>Q.&nbsp; Where are all of the scripts and bat files (ts/ts.bat,
ts_env/ts_env.bat,
etc.)?
</p>
<p>A.&nbsp; All platform script and bat files were removed and replaced
by the ANT equivalent.&nbsp; All properties from ts_env now are
configurable
in a given deliverable's build.properties file.&nbsp; All other scripts
are now accessible through ANT targets.&nbsp; This allows for
consistency
across different platforms and no reliance on unix toolkits on Win32
Platforms.&nbsp;
In the case of CTS, see the conversion table below for reference...
</p>
<p>CTS
1.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CTS 1.4
<br>
------------------------------------------------------------
<br>
ts/ts.bat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ant rungui
<br>
ts_env/ts_env.bat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$TS_HOME/build.properties
<br>
startrmiiiopserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ant startrmiiiopserver
</p>
<div style="margin-bottom: 0in;">startSunRIPortingServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ant startsunriportingserver</div>
<div style="margin-bottom: 0in;">tsmake
runclient&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ant runclient</div>
<div style="margin-bottom: 0in;">&nbsp;
<br>
<br>
<br>
<br>
Notes for updates that still need to be made to this guide<br>
<br>
--about TestUtil.init before any calls to getProperty</div>
&nbsp;
--create single test bundles for RI team to distribute<br>
<p style="margin-bottom: 0in;">-where to put tests
</p>
<p style="margin-bottom: 0in;">-creating deliv. specific ts.jar
</p>
<p style="margin-bottom: 0in;">--what to include in this jar
</p>
<p style="margin-bottom: 0in;">-what your TCK looks like in the ws and
in
a bundle
</p>
<p style="margin-bottom: 0in;">--sample deliverable example with just
sample
tests??
</p>
<p style="margin-bottom: 0in;">-what goes under
install/&lt;delivname&gt;/
</p>
<p style="margin-bottom: 0in;">-structure under
install/&lt;delivname&gt;
</p>
<p style="margin-bottom: 0in;">-subdirs should match top level dir
where
files are copied during setup
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
<br>
&nbsp;
</p>
<p style="margin-bottom: 0in;">-naming conventions for "_component"
jars
and wars to be passed to the deployment porting class
</p>
<p style="margin-bottom: 0in;">-link to java coding conventions
</p>
<p style="margin-bottom: 0in;">Where to put your tests
</p>
<p style="margin-bottom: 0in;">-directory organization
</p>
<p style="margin-bottom: 0in;">-when/(when not) to use tests/common
</p>
<p style="margin-bottom: 0in;">--when/(when not) to put code into
ts/lib
</p>
<p style="margin-bottom: 0in;">-Developing a test or set of tests
</p>
<p style="margin-bottom: 0in;">-needed files
</p>
<p style="margin-bottom: 0in;">-rules
</p>
<p style="margin-bottom: 0in;">--parent classes
</p>
<p style="margin-bottom: 0in;">---EETest
</p>
<p style="margin-bottom: 0in;">---ServiceEETest
</p>
<p style="margin-bottom: 0in;">--logging
</p>
<p style="margin-bottom: 0in;">---do tcks need to implement their own
loggerhandler
under TestUtil?
</p>
<p style="margin-bottom: 0in;">--testtags
</p>
<p style="margin-bottom: 0in;">---linking to assertion lists
</p>
-web content (where does it go)
<br>
&nbsp;
<p>&nbsp;<br>
&nbsp;
</p>
</body>
</html>
